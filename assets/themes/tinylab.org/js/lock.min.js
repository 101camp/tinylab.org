var os=function(){var b=navigator.userAgent,i=/(?:Windows Phone)/.test(b),c=/(?:SymbianOS)/.test(b)||i,h=/(?:Android)/.test(b),d=/(?:Firefox)/.test(b),a=/(?:Chrome|CriOS)/.test(b),f=/(?:iPad|PlayBook)/.test(b)||(h&&!/(?:Mobile)/.test(b))||(d&&/(?:Tablet)/.test(b)),g=/(?:iPhone)/.test(b)&&!f,e=!g&&!h&&!c;return{isTablet:f,isPhone:g,isAndroid:h,isPc:e}}();function getCookie(a){var b="; "+document.cookie;var c=b.split("; "+a+"=");if(c.length==2){return c.pop().split(";").shift()}}function getToken(){let value=getCookie("UM_distinctid");if(!value){return defaultToken}return value.substring(value.length-6).toUpperCase()}var locked=false;var articleSelector="#main-content";var toc="#toc_widget_container";var defaultToken="tinylab";$(articleSelector).ready(function(){var c=$(articleSelector)[0];if(c){var b=c.clientHeight;var a=b*0.3;var e=getToken();$("#locker").find(".token").text(e);var g=false;if(window.location.href.split("/").length<=4){g=true}console.log("articleElement is there, halfheight is",a);function h(){if(locked){$(articleSelector).css("height",a+"px");$(articleSelector).addClass("lock");$("#locker").css("display","block");$(toc).css("display","none")}else{$(articleSelector).css("height","initial");$(articleSelector).removeClass("lock");$("#locker").css("display","none");$(toc).css("display","block")}}function d(){$.ajax({url:"/users.xml",dataType:"xml",success:function(m){var k=m.getElementsByTagName("u");console.log("Detecting Token",e);for(var l=0;l<k.length;l++){var j=$(k[l]).text();console.log("Registered user",j);if(j==e){console.log("Detected Token",e);locked=false;break}}if(l==k.length){console.log("Not detected",e);locked=true}h()},error:function(i){locked=false;h()}})}var f=0;$("#locker").mouseover(function(){if(f==0){console.log("unlocking in 30 seconds ...");f=1;setTimeout(function(){console.log("unlock it now ...");locked=false;h()},30000)}});if(os.isPc&&a>800&&!g){d()}else{console.log("Lock did not work at",os)}}});