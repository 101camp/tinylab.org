var os=function(){var b=navigator.userAgent,i=/(?:Windows Phone)/.test(b),c=/(?:SymbianOS)/.test(b)||i,h=/(?:Android)/.test(b),d=/(?:Firefox)/.test(b),a=/(?:Chrome|CriOS)/.test(b),f=/(?:iPad|PlayBook)/.test(b)||(h&&!/(?:Mobile)/.test(b))||(d&&/(?:Tablet)/.test(b)),g=/(?:iPhone)/.test(b)&&!f,e=!g&&!h&&!c;return{isTablet:f,isPhone:g,isAndroid:h,isPc:e}}();function getCookie(a){var b="; "+document.cookie;var c=b.split("; "+a+"=");if(c.length==2){return c.pop().split(";").shift()}}function getToken(){let value=getCookie("UM_distinctid");if(!value){return defaultToken}return value.substring(value.length-6).toUpperCase()}var locked=false;var articleSelector="#main-content";var defaultToken="tinylab";$(articleSelector).ready(function(){var h=$(articleSelector)[0];if(h){var i=h.clientHeight;var f=i*0.3;var d=getToken();$("#locker").find(".token").text(d);var g=false;if(window.location.href.split("/").length<=4){g=true}console.log("articleElement is there, halfheight is",f);function e(){if(locked){$(articleSelector).css("height",f+"px");$(articleSelector).addClass("lock");$("#locker").css("display","block")}else{$(articleSelector).css("height","initial");$(articleSelector).removeClass("lock");$("#locker").css("display","none")}}function b(){$.ajax({url:"/users.xml",dataType:"xml",success:function(n){var l=n.getElementsByTagName("u");console.log("Detecting Token",d);for(var m=0;m<l.length;m++){var k=$(l[m]).text();if(k==d){console.log("Detected Token",d);locked=false;break}}if(m==l.length){console.log("Not detected",d);locked=true}e()},error:function(k){locked=false;e()}})}var a=0;var j=30000;function c(k){if(a==0){console.log("unlocking in ",k);a=1;setTimeout(function(){console.log("unlock it now ...");locked=false;e()},k)}}document.getElementById("unlocker").addEventListener("click",function(k){c(0)},false);document.getElementById("unlocker").addEventListener("touchstart",function(k){c(0)},false);if(f>800&&!g){b()}else{console.log("Lock did not work at",os)}}});